
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Independence</title>
    <meta name="description" content="">
    <meta name="author" content="Jason Liszka">

    <!-- Enable responsive viewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="/assets/themes/twitter/bootstrap/css/bootstrap.2.2.2.min.css" rel="stylesheet">
    <link href="/assets/themes/twitter/css/style.css?body=1&amp;v=2" rel="stylesheet" type="text/css" media="all">
    <link href="/assets/themes/twitter/css/pygment.css" rel="stylesheet" type="text/css" media="all">

    <!-- Le fav and touch icons -->
  <!-- Update these with your own images
    <link rel="shortcut icon" href="images/favicon.ico">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
  -->

    <!-- atom & rss feed -->
    <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
    <link href="/rss.xml" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  </head>

  <body>
    <div class="navbar">
      <div class="navbar-inner">
        <div class="container-narrow">
          <div class="row-fluid">
            <div class="span9 offset1">
              <a class="brand" href="/">A Gentleman and a Scala</a>
              <ul class="nav">
                
                
                


  
    
      
      	
      	<li><a href="/archive.html">Archive</a></li>
      	
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/tags.html">Tags</a></li>
      	
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  



              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="container-narrow">

      <div class="content">
        
<div class="row-fluid">
  <div class="span9 offset1 post-content post-spacer"></div>
</div>
<div class="row-fluid post-full">
  <div class="span9 offset1 post-content">
    <div class="page-header">
      <h1>Independence </h1>
    </div>
    <div class="date">
      <span>05 April 2016</span>
    </div>
    <div class="content">
      
<h3 id="an-empirical-test-for-independence">An empirical test for independence</h3>

<p>So that’s it! These rules make intuitive sense, but I think it would be fun to put them to an empirical test of some
sort. Since the rules make assertions about the independence of two events, we should find a test that determines independence
in a joint probability distribution.</p>

<p>A good test to use is the <a href="http://en.wikipedia.org/wiki/G-test">G-test</a>.
This test evaluates joint probability distribution of two events
by comparing it to a joint probability distribution of independent events.
The difference between these two distributions is a score that represents the likelihood that the two events in question
are independent.</p>

<p>Let’s first see what a joint probability distribution of two independent events looks like.</p>

<p>Here’s event A:</p>

<table>
  <thead>
    <tr>
      <th> </th>
      <th> </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>T</strong></td>
      <td>20%</td>
    </tr>
    <tr>
      <td><strong>F</strong></td>
      <td>80%</td>
    </tr>
  </tbody>
</table>

<p>Here’s event B:</p>

<table>
  <thead>
    <tr>
      <th> </th>
      <th> </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>T</strong></td>
      <td>60%</td>
    </tr>
    <tr>
      <td><strong>F</strong></td>
      <td>40%</td>
    </tr>
  </tbody>
</table>

<p>And here’s their joint probability distribution. The row labels are for event A and the column labels are for event B.</p>

<table>
  <thead>
    <tr>
      <th> </th>
      <th> </th>
      <th> </th>
      <th> </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td> </td>
      <td><strong>T</strong></td>
      <td><strong>F</strong></td>
      <td> </td>
    </tr>
    <tr>
      <td><strong>T</strong></td>
      <td>12%</td>
      <td>8%</td>
      <td>20%</td>
    </tr>
    <tr>
      <td><strong>F</strong></td>
      <td>48%</td>
      <td>32%</td>
      <td>80%</td>
    </tr>
    <tr>
      <td> </td>
      <td>60%</td>
      <td>40%</td>
      <td> </td>
    </tr>
  </tbody>
</table>

<p>You can see that this table is just the outer product of the individual probability distributions for A and B.</p>

<p>Suppose we observe a joint probability distribution that looks like this:</p>

<table>
  <thead>
    <tr>
      <th> </th>
      <th> </th>
      <th> </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td> </td>
      <td><strong>T</strong></td>
      <td><strong>F</strong></td>
    </tr>
    <tr>
      <td><strong>T</strong></td>
      <td>20%</td>
      <td>30%</td>
    </tr>
    <tr>
      <td><strong>F</strong></td>
      <td>40%</td>
      <td>10%</td>
    </tr>
  </tbody>
</table>

<p>The goal now is to reverse the process — we need to find a way to
“factor” this joint probability distribution into two individual probability distributions.
It’s impossible to do this exactly, but we can find something that’s close.</p>

<p>Let’s start by looking at the row and column totals.</p>

<table>
  <thead>
    <tr>
      <th> </th>
      <th> </th>
      <th> </th>
      <th> </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td> </td>
      <td><strong>T</strong></td>
      <td><strong>F</strong></td>
      <td> </td>
    </tr>
    <tr>
      <td><strong>T</strong></td>
      <td>20%</td>
      <td>30%</td>
      <td>50%</td>
    </tr>
    <tr>
      <td><strong>F</strong></td>
      <td>40%</td>
      <td>10%</td>
      <td>50%</td>
    </tr>
    <tr>
      <td> </td>
      <td>60%</td>
      <td>40%</td>
      <td> </td>
    </tr>
  </tbody>
</table>

<p>Now erase the inside of the table</p>

<table>
  <thead>
    <tr>
      <th> </th>
      <th> </th>
      <th> </th>
      <th> </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td> </td>
      <td><strong>T</strong></td>
      <td><strong>F</strong></td>
      <td> </td>
    </tr>
    <tr>
      <td><strong>T</strong></td>
      <td> </td>
      <td> </td>
      <td>50%</td>
    </tr>
    <tr>
      <td><strong>F</strong></td>
      <td> </td>
      <td> </td>
      <td>50%</td>
    </tr>
    <tr>
      <td> </td>
      <td>60%</td>
      <td>40%</td>
      <td> </td>
    </tr>
  </tbody>
</table>

<p>and multiply to figure out what the value is in each cell.</p>

<table>
  <thead>
    <tr>
      <th> </th>
      <th> </th>
      <th> </th>
      <th> </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td> </td>
      <td><strong>T</strong></td>
      <td><strong>F</strong></td>
      <td> </td>
    </tr>
    <tr>
      <td><strong>T</strong></td>
      <td>30%</td>
      <td>20%</td>
      <td>50%</td>
    </tr>
    <tr>
      <td><strong>F</strong></td>
      <td>30%</td>
      <td>20%</td>
      <td>50%</td>
    </tr>
    <tr>
      <td> </td>
      <td>60%</td>
      <td>40%</td>
      <td> </td>
    </tr>
  </tbody>
</table>

<p>This is the “expected” probability distribution.
Now we find the difference between the expected probability distribution and the actual probability distribution we observed.</p>

<table>
  <thead>
    <tr>
      <th> </th>
      <th> </th>
      <th> </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td> </td>
      <td><strong>T</strong></td>
      <td><strong>F</strong></td>
    </tr>
    <tr>
      <td><strong>T</strong></td>
      <td>-10%</td>
      <td>10%</td>
    </tr>
    <tr>
      <td><strong>F</strong></td>
      <td>10%</td>
      <td>-10%</td>
    </tr>
  </tbody>
</table>

<p>It might seem like a coincidence, but these numbers must have the same absolute value — the columns and rows must still add up
to the same thing as they did before, so altering the (T, T) cell in the expected distribution by some amount will alter the (T, F) and (F, T) cells
by the same amount (in the opposite direction), which in turn force the (F, F) cell to change by the same amount as well.</p>

<p>Now square each of these numbers and divide by the expected probability distribution.</p>

<table>
  <thead>
    <tr>
      <th> </th>
      <th> </th>
      <th> </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td> </td>
      <td><strong>T</strong></td>
      <td><strong>F</strong></td>
    </tr>
    <tr>
      <td><strong>T</strong></td>
      <td>1%/30%</td>
      <td>1%/20%</td>
    </tr>
    <tr>
      <td><strong>F</strong></td>
      <td>1%/30%</td>
      <td>1%/20%</td>
    </tr>
  </tbody>
</table>

<p>The sum of these numbers, times the total number of observations, is the <script type="math/tex">\chi^2</script> statistic. The construction
of this statistic is somewhat arbitrary, but it’s done this way on purpose to make the analysis easier.</p>

<pre><code>x is normally distributed around 0 with stdev = sqrt(pq(1-pq)) / sqrt(n)
x/sqrt(pq(1-pq)/n) is normally distributed
nx^2/pq(1-pq) is a chi2 distribution with df=1

  nx^2[ 1/pq + 1/(1-p)q + 1/p(1-q) + 1/(1-p)(1-q) ]
= nx^2[ (1-p)(1-q) + p(1-q) + (1-p)q + pq ] / pq(1-p)(1-q)
= nx^2[ 1 - p - q + pq + p - pq + q - pq + pq ] / pq(1-p)(1-q)
= nx^2 / pq(1-p)(1-q)

= nx^2[ 1/pq + 1/(1-pq) ]
= nx^2[ pq + (1-pq) ] / pq(1-pq)
= nx^2 / pq(1-pq)

O log (O / E)
N p(x) log (p(x) / q(x))
</code></pre>

<p>Given two events that are actually independent, by how much do we expect this statistic to vary? It’s easy
to model:</p>

<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">def</span> <span class="n">chi2dist</span><span class="o">(</span><span class="n">n</span><span class="k">:</span> <span class="kt">Int</span><span class="o">,</span> <span class="n">p</span><span class="k">:</span> <span class="kt">Double</span><span class="o">,</span> <span class="n">q</span><span class="k">:</span> <span class="kt">Double</span><span class="o">)</span> <span class="k">=</span> <span class="o">{</span>
  <span class="k">val</span> <span class="n">d</span> <span class="k">=</span> <span class="k">for</span> <span class="o">{</span>
    <span class="n">a</span> <span class="k">&lt;-</span> <span class="n">tf</span><span class="o">(</span><span class="n">p</span><span class="o">)</span>
    <span class="n">b</span> <span class="k">&lt;-</span> <span class="n">tf</span><span class="o">(</span><span class="n">q</span><span class="o">)</span>
  <span class="o">}</span> <span class="k">yield</span> <span class="n">a</span> <span class="o">&amp;&amp;</span> <span class="n">b</span>
  <span class="n">d</span><span class="o">.</span><span class="n">repeat</span><span class="o">(</span><span class="n">n</span><span class="o">).</span><span class="n">map</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">count</span><span class="o">(</span><span class="k">_</span> <span class="o">==</span> <span class="kc">true</span><span class="o">).</span><span class="n">toDouble</span> <span class="o">/</span> <span class="n">n</span> <span class="o">-</span> <span class="n">p</span><span class="o">*</span><span class="n">q</span><span class="o">).</span><span class="n">map</span><span class="o">(</span><span class="n">x</span> <span class="k">=&gt;</span> <span class="n">x</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="o">(</span><span class="n">p</span> <span class="o">*</span> <span class="n">q</span> <span class="o">*</span> <span class="o">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">p</span> <span class="o">*</span> <span class="n">q</span><span class="o">)</span> <span class="o">/</span> <span class="n">n</span><span class="o">))</span>
<span class="o">}</span>

<span class="k">def</span> <span class="n">chi2dist2</span><span class="o">(</span><span class="n">n</span><span class="k">:</span> <span class="kt">Int</span><span class="o">,</span> <span class="n">p</span><span class="k">:</span> <span class="kt">Double</span><span class="o">,</span> <span class="n">q</span><span class="k">:</span> <span class="kt">Double</span><span class="o">)</span> <span class="k">=</span> <span class="o">{</span>
  <span class="k">val</span> <span class="n">d</span> <span class="k">=</span> <span class="k">for</span> <span class="o">{</span>
    <span class="n">a</span> <span class="k">&lt;-</span> <span class="n">tf</span><span class="o">(</span><span class="n">p</span><span class="o">)</span>
    <span class="n">b</span> <span class="k">&lt;-</span> <span class="n">tf</span><span class="o">(</span><span class="n">q</span><span class="o">)</span>
  <span class="o">}</span> <span class="k">yield</span> <span class="n">a</span> <span class="o">&amp;&amp;</span> <span class="n">b</span>
  <span class="n">d</span><span class="o">.</span><span class="n">repeat</span><span class="o">(</span><span class="n">n</span><span class="o">).</span><span class="n">map</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">count</span><span class="o">(</span><span class="k">_</span> <span class="o">==</span> <span class="kc">true</span><span class="o">).</span><span class="n">toDouble</span> <span class="o">/</span> <span class="n">n</span> <span class="o">-</span> <span class="n">p</span><span class="o">*</span><span class="n">q</span><span class="o">).</span><span class="n">map</span><span class="o">(</span><span class="n">x</span> <span class="k">=&gt;</span> <span class="n">x</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="o">(</span><span class="n">p</span> <span class="o">*</span> <span class="n">q</span> <span class="o">*</span> <span class="o">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">p</span><span class="o">)</span> <span class="o">*</span> <span class="o">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">q</span><span class="o">)</span> <span class="o">/</span> <span class="n">n</span><span class="o">))</span>
<span class="o">}</span>

<span class="k">def</span> <span class="n">chi2test</span><span class="o">(</span><span class="n">n</span><span class="k">:</span> <span class="kt">Int</span><span class="o">,</span> <span class="n">k</span><span class="k">:</span> <span class="kt">Int</span><span class="o">,</span> <span class="n">p</span><span class="k">:</span> <span class="kt">Double</span><span class="o">,</span> <span class="n">q</span><span class="k">:</span> <span class="kt">Double</span><span class="o">)</span> <span class="k">=</span> <span class="o">{</span>

<span class="o">}</span>

<span class="k">def</span> <span class="n">chi2test</span><span class="o">(</span><span class="n">n</span><span class="k">:</span> <span class="kt">Int</span><span class="o">,</span> <span class="n">a</span><span class="k">:</span> <span class="kt">Int</span><span class="o">,</span> <span class="n">b</span><span class="k">:</span> <span class="kt">Int</span><span class="o">,</span> <span class="n">c</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="k">=</span> <span class="o">{</span>
  <span class="k">val</span> <span class="n">d</span> <span class="k">=</span> <span class="k">for</span> <span class="o">{</span>
    <span class="n">p</span> <span class="k">&lt;-</span> <span class="n">uniform</span>
    <span class="n">q</span> <span class="k">&lt;-</span> <span class="n">uniform</span>
    <span class="o">(</span><span class="n">aa</span><span class="o">,</span> <span class="n">bb</span><span class="o">,</span> <span class="n">cc</span><span class="o">)</span> <span class="k">&lt;-</span> <span class="o">(</span><span class="n">tf</span><span class="o">(</span><span class="n">p</span><span class="o">)</span> <span class="n">zip</span> <span class="n">tf</span><span class="o">(</span><span class="n">q</span><span class="o">)).</span><span class="n">repeat</span><span class="o">(</span><span class="n">n</span><span class="o">).</span><span class="n">map</span><span class="o">(</span><span class="n">abs</span> <span class="k">=&gt;</span> <span class="o">(</span><span class="n">abs</span><span class="o">.</span><span class="n">count</span><span class="o">(</span><span class="k">_</span> <span class="o">==</span> <span class="o">(</span><span class="kc">true</span><span class="o">,</span> <span class="kc">true</span><span class="o">)),</span> <span class="n">abs</span><span class="o">.</span><span class="n">count</span><span class="o">(</span><span class="k">_</span> <span class="o">==</span> <span class="o">(</span><span class="kc">true</span><span class="o">,</span> <span class="kc">false</span><span class="o">)),</span> <span class="n">abs</span><span class="o">.</span><span class="n">count</span><span class="o">(</span><span class="k">_</span> <span class="o">==</span> <span class="o">(</span><span class="kc">false</span><span class="o">,</span> <span class="kc">true</span><span class="o">))))</span>
  <span class="o">}</span> <span class="k">yield</span> <span class="o">(</span><span class="n">aa</span><span class="o">,</span> <span class="n">bb</span><span class="o">,</span> <span class="n">cc</span><span class="o">,</span> <span class="n">p</span><span class="o">,</span> <span class="n">q</span><span class="o">)</span>
  <span class="n">d</span><span class="o">.</span><span class="n">filter</span><span class="o">(</span><span class="n">x</span> <span class="k">=&gt;</span> <span class="n">x</span><span class="o">.</span><span class="n">_1</span> <span class="o">==</span> <span class="n">a</span> <span class="o">&amp;&amp;</span> <span class="n">x</span><span class="o">.</span><span class="n">_2</span> <span class="o">==</span> <span class="n">b</span> <span class="o">&amp;&amp;</span> <span class="n">x</span><span class="o">.</span><span class="n">_3</span> <span class="o">==</span> <span class="n">c</span><span class="o">).</span><span class="n">map</span><span class="o">(</span><span class="n">x</span> <span class="k">=&gt;</span> <span class="o">(</span><span class="n">x</span><span class="o">.</span><span class="n">_4</span><span class="o">,</span> <span class="n">x</span><span class="o">.</span><span class="n">_5</span><span class="o">))</span>
<span class="o">}</span></code></pre></div>


    </div>

  

  


  <div style="float: right; margin-top: 5px">
  <a href="https://twitter.com/share" class="twitter-share-button" data-url="http://jliszka.github.io/drafts/independence.html" data-text="Independence" data-via="jliszka">Tweet</a>
  <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
</div>




  
    <div style="clear: both"></div>

    <hr>
    <div class="navigation">
    
    
      <div style="clear: both"></div>
    </div>
    <hr>
    


  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'jliszka'; // required: replace example with your forum shortname
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




  </div>

  <div class="span2 sidebar">
    <a href="/"><div id="photo"></div></a>
    <div id="bio">
      <b>Jason Liszka</b><br/>
      <i>Engineer at Slack NYC, CMU alum, Scala fan, new father</i>
    </div>
    <h4>Popular posts</h4>
    <ul>
      <li><a href="/2013/10/01/how-traffic-actually-works.html">How traffic actually works</a></li>
      <li><a href="/2013/08/12/a-frequentist-approach-to-probability.html">A frequentist approach to probability</a></li>
      <li><a href="/2013/10/24/exact-numeric-nth-derivatives.html">Exact numeric nth derivatives</a></li>
      <li><a href="/2013/10/31/infinite-lazy-polynomials.html">Infinite lazy polynomials</a></li>
    </ul>

    <h4>Recent posts</h4>
    <ul>
      
        <li><a href="/2016/04/05/probability-is-in-the-process.html">Probability is in the process</a></li>
      
        <li><a href="/2014/07/31/the-quantum-eraser.html">The quantum eraser demystified</a></li>
      
        <li><a href="/2014/07/12/is-the-nba-draft-rigged.html">Is the NBA draft rigged?</a></li>
      
        <li><a href="/2014/06/03/programming-with-futures.html">Programming with futures: patterns and anti-patterns</a></li>
      
        <li><a href="/2014/01/30/good-tech-lead-bad-tech-lead.html">Good Tech Lead, Bad Tech Lead</a></li>
      
    </ul>

    <a href="https://twitter.com/jliszka" class="twitter-follow-button" data-show-count="false" data-size="large" data-show-screen-name="false">Follow @jliszka</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

  </div>
</div>


      </div>
      <hr>
      <footer>
        <p>&copy; 2016 Jason Liszka
          with help from <a href="http://jekyllbootstrap.com" target="_blank" title="The Definitive Jekyll Blogging Framework">Jekyll Bootstrap</a>
          and <a href="http://twitter.github.com/bootstrap/" target="_blank">Twitter Bootstrap</a>
        </p>
      </footer>

    </div>

    


  <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-42567355-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>



  </body>
</html>

